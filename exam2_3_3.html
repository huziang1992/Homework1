<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Ziang Hu-Exam2_3.3</title>
    <script type="text/javascript" src="d3/d3.js"></script>
    <style type="text/css">
#head{
	margin-left:25%;
	font-size: 40px;
	margin-bottom: 0px;
}
#head2{
	margin-right:20%;
	font-size: 30px;
	float: right;
	margin-top:0px;
}
#datasource{
	margin-left:25%;
	font-size: 20px;
	margin-top:25px;
}
table{
	width:50%;
  height:30%;
  margin:auto;
  text-align:right;
}
table th{
	background: lightgrey;
}
table td{
	width:40px;
}

h1{

   pointer-events:none;

}
p{
   pointer-events:none;
	
}

</style>
  </head>
  
<body>
<h1 id="head">Spreadsheet with SimulSor of 3.3</h1>  
<h1 id="head2">----Ziang Hu</h1>
<a href="http://hivelab.org/static/exam2.json"> <h1 id="datasource"> Data source: http://hivelab.org/static/exam2.json </h1> </a>

<table id="spreadsheet"border=1px>
              <thead>
                <tr>
				        <th ><p>ItemNo</p></th>
                  <th ><p>A</p></th>
                  <th ><p>B</p></th>
                  <th ><p>C</p></th>
                  <th ><p>D</p></th>
                  <th ><p>E</p></th>
                  <th ><p>F</p></th>
                  <th ><p>G</p></th>
                </tr>
              </thead>

              <tbody>
               
              </tbody>
            </table>

<script type="text/javascript">

          var sortorder=0;

      		d3.json("exam2.json",function(dataset){

              var ItemNo=dataset.map(function(d,i) {return {"value":d.ItemNo,"id":i+1}}).sort(function(a,b){return a.value<b.value? 1:-1 ;});
              var column_A=dataset.map(function(d,i) {return {"value":d.A,"id":i+1}}).sort(function(a,b){return a.value<b.value? 1:-1 ;});
              var column_B=dataset.map(function(d,i) {return {"value":d.B,"id":i+1}}).sort(function(a,b){return a.value<b.value? 1:-1 ;});
              var column_C=dataset.map(function(d,i) {return {"value":d.C,"id":i+1}}).sort(function(a,b){return a.value<b.value? 1:-1 ;});
              var column_D=dataset.map(function(d,i) {return {"value":d.D,"id":i+1}}).sort(function(a,b){return a.value<b.value? 1:-1 ;});
              var column_E=dataset.map(function(d,i) {return {"value":d.E,"id":i+1}}).sort(function(a,b){return a.value<b.value? 1:-1 ;});
              var column_F=dataset.map(function(d,i) {return {"value":d.F,"id":i+1}}).sort(function(a,b){return a.value<b.value? 1:-1 ;});
              var column_G=dataset.map(function(d,i) {return {"value":d.G,"id":i+1}}).sort(function(a,b){return a.value<b.value? 1:-1 ;});
              // console.log(ItemNo);
              // console.log(column_A);
              // console.log(column_B);
              // console.log(column_C);
              // console.log(column_D);
              // console.log(column_E);
              // console.log(column_F);
              // console.log(column_G);

      		var  row=d3.select("tbody")
      				.selectAll(".row")
      				.data(dataset)
      				.enter()
      				.append("tr")
      				.attr("class","row");

      		var cell=row.append("td")
                .data(ItemNo)
      					.text(function(d){return d.value})
      					.attr("class","cell");

      				row.append("td")
                .data(column_A)
                .text(function(d){return d.value})
      					 .attr("class","cell");

      				row.append("td")
                .data(column_B)
                .text(function(d){return d.value})
      					 .attr("class","cell");

      				row.append("td")
                .data(column_C)
                .text(function(d){return d.value})
      					.attr("class","cell");

      				row.append("td")
                .data(column_D)
                .text(function(d){return d.value})
      					.attr("class","cell");

      				row.append("td")
                .data(column_E)
                .text(function(d){return d.value})
      					.attr("class","cell");

      				row.append("td")
                .data(column_F)
                .text(function(d){return d.value})
      					.attr("class","cell");

      				row.append("td")
                .data(column_G)
                .text(function(d){return d.value})
      					.attr("class","cell");

                d3.selectAll(".cell").attr("click","N");

              highlight();

              

              

      		});


function highlight(){

            d3.selectAll(".cell")
              .on("mouseover",function(d){

                  var rowmark=d.id;

                  //console.log(rowmark);

                d3.selectAll(".cell")
                    .style("background",function(d){
                      if(d3.select(this).attr("click")=="N")
                      {if(d.id == rowmark)
                        return "yellow";
                      else
                        return "none";}
                      if(d3.select(this).attr("click")=="Y")
                        return "green";

                    });
              })
              .on("mouseout",function(d){

                  d3.selectAll(".cell")
                    .style("background",function(d){
                      if(d3.select(this).attr("click")=="N")
                        return "none";
                      if(d3.select(this).attr("click")=="Y")
                        return "green";

                    });



              })
              .on("click",function(d){


                  var rowmark=d.id;

                  d3.selectAll(".cell").attr("click",function(d){

                      if(d.id==rowmark)
                        return "Y";
                      else
                        return "N";


                  });

                   d3.selectAll(".cell")
                    .style("background",function(d){
                      if(d.id == rowmark)
                        return "green";
                    });

                });





}



    </script>
  </body>
</html>